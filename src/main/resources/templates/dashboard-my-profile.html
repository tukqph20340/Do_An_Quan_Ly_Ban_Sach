<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>

	<!-- Basic Page Needs
    ================================================== -->
	<title>Admin Page</title>
	<meta charset="utf-8">
	<meta name="viewport"
		  content="width=device-width, initial-scale=1, maximum-scale=1">

	<!-- CSS
    ================================================== -->
	<link rel="stylesheet" href="/listeo/css/style.css">
	<link rel="stylesheet" href="/listeo/css/main-color.css" id="colors">
	<link rel="icon" href="/img/logo-3.png">
</head>

<body>

<!-- Wrapper -->
<div id="wrapper">

	<!-- Header Container
================================================== -->
	<header id="header-container" class="fixed fullwidth dashboard">

		<!-- Header -->
		<div id="header" class="not-sticky" style="background: white">
			<div class="container">

				<!-- Left Side Content -->
				<div class="left-side">

					<!-- Logo -->
					<div id="logo" style="background: white;">
						<a href="index.html"><img src="/images/logo3.png" height="100px" width="180px" alt=""></a>
						<a href="index.html" class="dashboard-logo" style="margin-left: 14px;"><img
								src="/images/logo3.png" height="100px" width="180px" alt=""></a>
					</div>

					<!-- Mobile Navigation -->
					<div class="mmenu-trigger">
						<button class="hamburger hamburger--collapse" type="button">
								<span class="hamburger-box"> <span
										class="hamburger-inner"></span>
								</span>
						</button>
					</div>
					<div class="clearfix"></div>
					<!-- Main Navigation / End -->

				</div>
				<!-- Left Side Content / End -->

				<!-- Right Side Content / End -->
				<div class="right-side">
					<!-- Header Widget -->
					<div class="header-widget">

						<!-- User Menu -->


					</div>
					<!-- Header Widget / End -->
				</div>
				<!-- Right Side Content / End -->
			</div>
		</div>
		<!-- Header / End -->

	</header>
	<div class="clearfix"></div>
	<!-- Header Container / End -->


	<!-- Dashboard -->
	<div id="dashboard">

		<!-- Navigation
================================================== -->

		<!-- Responsive Navigation Trigger -->
		<a href="#" class="dashboard-responsive-nav-trigger"><i
				class="fa fa-reorder"></i> Dashboard Navigation</a>

		<div class="dashboard-nav" style="background: white">
			<div class="dashboard-nav-inner">
				<ul data-submenu-title="Trang Chủ">
					<li class="active"><a href="/home-admin"><i class="sl sl-icon-settings"></i> <span
							style="font-weight: bold; color: black;">Trang Chủ</span></a></li>
					<li><a href="/thong-ke"><i class="sl sl-icon-wallet"></i> <span
							style="font-weight: bold; color: black;">Thông Kê</span></a></li>
					<li><a href="/quan-ly-don-hang"><i class="fa fa-calendar-check-o"></i> <span
							style="font-weight: bold; color: black;">Quản Lý Hóa Đơn</span></a></li>
					<ul data-submenu-title="Sản Phẩm">
						<li><a href="#"><i class="sl sl-icon-layers"></i> <span
								style="font-weight: bold; color: black;">Quản Lý Sản Phẩm</span></a>
							<ul id="sub">
								<li><a href="/san-pham-admin"><span
										style="font-weight: bold; color: black;">Sản Phẩm</span></a></li>
								<li><a href="/tac-gia-admin"><span
										style="font-weight: bold; color: black;">Tác Giả</span></a></li>
								<li><a href="/nha-san-xuat-admin"><span style="font-weight: bold; color: black;">Nhà Xuất Bản</span></a>
								</li>
								<li><a href="/bia-admin"><span style="font-weight: bold; color: black;">Bìa Sách</span></a>
								</li>
								<li><a href="/the-loai-admin"><span style="font-weight: bold; color: black;">Thể Loại Sách</span></a>
								</li>
								<li><a href="/khuyen-mai/admin"><span style="font-weight: bold; color: black;">Khuyến mãi</span></a>
								</li>
							</ul>
						</li>
					</ul>
					<ul data-submenu-title="Người Dùng">
						<li><a href="/nguoi-dung-admin"><i class="sl sl-icon-user"></i> <span
								style="font-weight: bold; color: black;">Quản Lý Tài Khoản</span></a></li>
						<li><a href="/dang-xuat"><i class="sl sl-icon-power"></i> <span
								style="font-weight: bold; color: black;">Đăng Xuất</span></a></li>
					</ul>
					<ul data-submenu-title="Home">
						<li><a href="/dashboard-myprofile"><i class="sl sl-icon-user"></i> <span
								style="font-weight: bold; color: black;">Đổi Mật Khẩu</span></a></li>
						<li><a href="/home"><i class="im im-icon-Home"></i> <span
								style="font-weight: bold; color: black;">Trang Chủ</span></a></li>
					</ul>
				</ul>
			</div>
		</div>
			<!-- Navigation / End -->


			<!-- Content
	================================================== -->
			<div class="dashboard-content">

				<!-- Titlebar -->

				<div class="row">

					<!-- Profile -->
					<div class="col-lg-6 col-md-12">
						<form action="/dashboard-myprofile/changeProfile" method="POST"
							enctype="multipart/form-data">
							<div class="dashboard-list-box margin-top-0">
								<h4 class="gray">Thông Tin Tài Khoản</h4>
								<div class="dashboard-list-box-static">
									<!-- Avatar -->
									<div class="edit-profile-photo">
										<img th:src="${admin.avatar}" alt="">
										<div class="change-photo-btn">
											<div class="photoUpload">
												<span><i class="fa fa-upload"></i> Tải Ảnh</span> <input
													name="avatar" type="file" accept="image/*" class="upload" />
											</div>
										</div>
									</div>

									<!-- Details -->
									<div class="my-profile">

										<label>Họ Và Tên</label> <input name="fullname" th:value="${admin.user_Name}"
											type="text"> <label>Số Điện Thoại</label> <input name="phone"
											th:value="${admin.phone_Number}" type="text"> <label>Email</label>
										<input name="email" th:value="${admin.email}" type="text">
									</div>
									<span style="color: green;" th:if="${messageChangeProfile != null}" th:text="${messageChangeProfile}"></span><br>
									<button class="button margin-top-15">Lưu Thông Tin</button>

								</div>
							</div>
						</form>
					</div>

					<!-- Change Password -->
					<div class="col-lg-6 col-md-12">
						<form action="/dashboard-myprofile/changepassword" method="post" id="yourFormId">
							<div class="dashboard-list-box margin-top-0">
								<h4 class="gray">Đổi Mật Khẩu</h4>
								<div class="dashboard-list-box-static">

									<!-- Change Password -->
									<div class="my-profile">
										<label class="margin-top-0">Mật Khẩu Cũ</label>
										<input id="pass"
											name="current_password" type="password">
										<label>Mật Khẩu Mới</label>
										<input id="passnew" name="new_password" type="password">
										<label>Xác Nhận Mật Khẩu</label>
										<input id="passnew1"
											name="confirm_password" type="password">
										<p th:if="${error_change_pass!=null}" style="color: red;"
											th:text="${error_change_pass}"></p>
										<button type="button" id="submitButton" class="button margin-top-15">Đổi Mật Khẩu</button>
									</div>
								</div>
							</div>
						</form>
					</div>


					<!-- Copyrights -->
					<div class="col-md-12">
						<div class="copyrights"></div>
					</div>

				</div>

			</div>
			<!-- Content / End -->


		</div>
		<!-- Dashboard / End -->


	</div>
	<!-- Wrapper / End -->


	<!-- Scripts
================================================== -->
	<script type="text/javascript" src="scripts/jquery-3.6.0.min.js"></script>
	<script type="text/javascript"
		src="scripts/jquery-migrate-3.3.2.min.js"></script>
	<script type="text/javascript" src="scripts/mmenu.min.js"></script>
	<script type="text/javascript" src="scripts/chosen.min.js"></script>
	<script type="text/javascript" src="scripts/slick.min.js"></script>
	<script type="text/javascript" src="scripts/rangeslider.min.js"></script>
	<script type="text/javascript" src="scripts/magnific-popup.min.js"></script>
	<script type="text/javascript" src="scripts/waypoints.min.js"></script>
	<script type="text/javascript" src="scripts/counterup.min.js"></script>
	<script type="text/javascript" src="scripts/jquery-ui.min.js"></script>
	<script type="text/javascript" src="scripts/tooltips.min.js"></script>
	<script type="text/javascript" src="scripts/custom.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>

<script type="text/javascript">
	$(document).ready(function() {
		$("#submitButton").click(function() {
			// Hiển thị SweetAlert2 xác nhận
			Swal.fire({
				title: 'Bạn có muốn thay đổi mật khẩu?',
				icon: 'question',
				showCancelButton: true,
				confirmButtonColor: '#3085d6',
				cancelButtonColor: '#d33',
				confirmButtonText: 'Đồng ý'
			}).then((result) => {
				if (result.isConfirmed) {
					// Nếu người dùng đồng ý, thực hiện AJAX request
					var formData = new FormData($("#yourFormId")[0]);
					var passnew = document.getElementById("passnew").value;
					var pass = document.getElementById("pass").value;
					var passnew1 = document.getElementById("passnew1").value;

					if (!passnew.trim() || !pass.trim() || !passnew1.trim()) {
						Swal.fire('Lỗi!', 'Vui lòng điền đầy đủ thông tin cần thêm!', 'error');
						console.log(pass,passnew,passnew1);
						return;
					}
					if (passnew === pass) {
						Swal.fire('Lỗi!', 'Mật khẩu mới phải khác với mật khẩu cũ!', 'error');
						return;
					} else if (passnew !== passnew1) {
						Swal.fire('Lỗi!', 'Mật khẩu mới và xác nhận không khớp!', 'error');
						return;
					} else {
						$.ajax({
							type: "POST",
							url: "/dashboard-myprofile/changepassword",
							data: formData,
							processData: false,
							contentType: false,
							success: function (response) {
								Swal.fire({
									icon: 'success',
									title: 'Đổi thành công, Mời bạn đăng nhập lại!',
									time: 1000,
								}).then(function () {
									window.location.href = '/signin-admin';
								});
							},
							error: function (error) {
								// Xử lý lỗi nếu cần thiết
							}
						});
					}
				}
			});
		});
	});
</script>
</body>
</html>
